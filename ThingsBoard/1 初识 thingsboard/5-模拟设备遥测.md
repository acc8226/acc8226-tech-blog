thingsboard 作为一个多租户的物联网平台，文档也很齐全。后端使用的是 java 语言编写的，已通过 swagger 来暴露接口文档。tb 的所有服务都可以通过接口来看到。

接口主要分为两部分，一部分是设备 API，另一部分是用于服务端 API。 在我们启动 tb 之后，可以通过 <http://ip+port/swagger-ui.html> 来访问 tb 的所有接口。

以我的 tb 为例，我在本地搭建的服务，所以接口文档的 swagger 的文档可直接访问 <http://localhost:8080/swagger-ui.html/> 打开 swagger 文档之后，你会看到 tb 所有的接口，这里边有太多接口。

首先那顶部我们可以对接口进行授权，授权之后，就能直接在这个页面对接口进行测试，并且直接调用接口来创建，删除数据。非常方便快捷。

下面来演示一下。 点击右上角的 Authorize 按钮，会有一个弹窗。输入正确的用户名和密码点击会调用`api/auth/login` 接口完成登录 。之后的请求头都会带上该 JWT token。

```text
X-Authorization: Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJ0Z...
```

这里列举一下 TB 的接口模块,一共分为 26 个模块

1. admin-controller : Admin Controller 管理员接口
2. alarm-controller : Alarm Controller 告警模块接口
3. asset-controller : Asset Controller 资产接口
4. audit-log-controller : Audit Log Controller 审核日志接口
5. auth-controller : Auth Controller 授权接口
6. component-descriptor-controller : Component Descriptor Controller 组件描述接口
7. customer-controller : Customer Controller 客户接口
8. dashboard-controller : Dashboard Controller 面板接口
9. device-api-controller : Device Api Controller 设备API接口
10. device-controller : Device Controller 设备接口
11. device-profile-controller : Device Profile Controller 设备简要接口
12. entity-query-controller : Entity Query Controller 实体查询接口
13. entity-relation-controller : Entity Relation Controller 实体关联接口
14. entity-view-controller : Entity View Controller 实体视图接口
15. event-controller : Event Controller 事件接口
16. o-auth-2-config-template-controller : O Auth 2 Config Template Controller OAuth2.0配置模块接口
17. o-auth-2-controller : O Auth 2 Controller OAuth2接口
18. queue-controller : Queue Controller 队列接口
19. rpc-controller : Rpc Controller rpc接口
20. rule-chain-controller : Rule Chain Controller 规则链接口
21. telemetry-controller : Telemetry Controller 遥测接口
22. tenant-controller : Tenant Controller 租户接口
23. tenant-profile-controller : Tenant Profile Controller 租户简介接口
24. user-controller : User Controller 用户接口
25. widget-type-controller : Widget Type Controller 部件类型接口
26. widgets-bundle-controller : Widgets Bundle Controller 部件构建接口

## 模拟遥测

tb 不仅仅将所有的文档都导出了，而且还做了有关设备相关的接口。在使用物联网平台是，我们经常需要买一些硬件来测试平台，到有时我们根本买不起那些硬件，或者我们只是抱着试试的太多来了解这个平台，如果要因为尝试，而要买一大堆硬件，成本就有点高了。tb 也想到了这个问题，所有他们提供了接口让你来模拟设备。

我们来简单说一下物理网的一般的数据流是怎么流转的。

一般是设备连上网后，就要链接到平台注册自己，然后保持在线状态，设备有任何操作，都会向平台或服务器发送一个指令，这个请求会很小，因为限于设备的通信，存储能力。很多时候只有一个消息体字段。服务器接受消息后，就会对数据进行相应的判断，处理，显示给用户，添加到面板上。

而遥测技术遥测（英文名称：telemetering）是将对象参量的近距离测量值传输至远距离的测量站来实现远距离测量的技术。遥测技术是一个集成性能好的，具有良好的跟踪性能、遥控性能的一种新型的技术，其应用很广泛

在 tb 中要对设备进行模拟遥测也是一件很简单的是。

首先在设备列表中，我们找到一个设备，复制出来一个设备的凭证。

然后可以使用 postman，或者 curl 来发送一个遥测数据。

下面以 windows 下来操作一些。 使用 curl 来发送给一个 post 请求 执行的代码是

```sh
curl -v -X POST \
-d "{\"temperature\": 25}" \
http://localhost:8080/api/v1/T2_TEST_TOKEN/telemetry \
--header "Content-Type:application/json"
```

T2_TEST_TOKEN 就是设备的访问凭证，替换成自己的就可以了。这个遥测发送了一个属性 temperature，属性值为 25。

## 参考

ThingsBoard教程（七）：模拟设备遥测_专栏_易百纳技术社区
<https://www.ebaina.com/articles/140000005587>
