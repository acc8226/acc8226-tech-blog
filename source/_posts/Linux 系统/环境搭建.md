## 更新 CentOS 系统

可查看您当前的系统内核版本。如需要升级，可以进行如下操作：
`cat /etc/centos-release`

Step 1 编辑 yum.conf
在 /etc/yum.conf 中，注释：`exclude kernel* centos-release*`

Step 2 升级所有软件包
输入命令：`yum update`
此命令将升级 CentOS 系统和所有相关的软件包到软件源提供的最新版本。

Step 3 确认升级完成
升级完成后，再次输入命令：
`cat /etc/centos-release`
此时会展示升级后的系统版本。

### 安装 java

`yum -y install java`

### 安装 Apache 服务

使用 yum 安装 Apache
`yum install httpd -y`

启动 Apache 服务：
`service httpd start`

还有 stop, restart 命令
`service httpd stop`
`service httpd restart`

### 安装 PHP

安装 PHP 和 PHP-MYSQL 支持工具：

```bash
yum install php php-mysql -y
```

### 安装 Mysql

完成以下操作，安装 MySQL。
运行以下命令更新 YUM 源。
`rpm -Uvh  http://dev.mysql.com/get/mysql57-community-release-el7-9.noarch.rpm`
运行以下命令安装MySQL。
`yum -y install mysql-community-server`
运行以下命令查看 MySQL 版本号。
`mysql -V`

运行以下命令启动 MySQL 服务。
`systemctl start mysqld`
运行以下命令设置 MySQL 服务开机自启动。
`systemctl enable mysqld`

运行以下命令查看 /var/log/mysqld.log 文件，获取并记录 root 用户的初始密码。

```sh
# grep 'temporary password' /var/log/mysqld.log
2016-12-13T14:57:47.535748Z 1 [Note] A temporary password is generated for root@localhost: p0/G28g>lsHD
```

说明 下一步重置 root 用户密码时，会使用该初始密码。 这里我举个例子设置为 `5gPpp;..`
运行以下命令配置 MySQL 的安全性。
`mysql_secure_installation`
安全性的配置包含以下五个方面：

重置 root 账号密码。

```text
Enter password for user root: #输入上一步获取的root用户初始密码
The 'validate_password' plugin is installed on the server.
The subsequent steps will run with the existing configuration of the plugin.
Using existing password for root.
Estimated strength of the password: 100
Change the password for root ? ((Press y|Y for Yes, any other key for No) : Y #是否更改root用户密码，输入Y
New password: #输入新密码，长度为 8 至 30 个字符，必须同时包含大小写英文字母、数字和特殊符号。特殊符号可以是()` ~!@#$%^&*-+=|{}[]:;‘<>,.?/
Re-enter new password: #再次输入新密码
Estimated strength of the password: 100
Do you wish to continue with the password provided?(Press y|Y for Yes, any other key for No) : Y
```

输入 Y 删除匿名用户账号。

```text
By default, a MySQL installation has an anonymous user, allowing anyone to log into MySQL without having to have a user account created for them. This is intended only for testing, and to make the installation go a bit smoother. You should remove them before moving into a production environment.
Remove anonymous users? (Press y|Y for Yes, any other key for No) : Y  #是否删除匿名用户，输入Y
Success.
```

输入 Y 禁止 root 账号远程登录。

```sh
Disallow root login remotely? (Press y|Y for Yes, any other key for No) : Y #禁止root远程登录，输入Y
Success.
```

输入 Y 删除 test 库以及对 test 库的访问权限。

```text
Remove test database and access to it? (Press y|Y for Yes, any other key for No) : Y #是否删除test库和对它的访问权限，输入Y
- Dropping test database...
Success.
```

输入 Y 重新加载授权表。

```sh
Reload privilege tables now? (Press y|Y for Yes, any other key for No) : Y #是否重新加载授权表，输入Y
Success.
All done!
```

运行以下命令后，输入 root 用户的密码登录 MySQL。
`mysql -uroot -p`

依次运行以下命令创建远程登录 MySQL 的账号。示例账号为 dms、密码为 123456。

```sh
grant all on *.* to 'dms'@'%'IDENTIFIED BY '6gPpp;..'; #使用root替换dms，可设置为允许root账号远程登录。
mysql> flush privileges;
```

#### 登录 MySQL 的两种方式

1\. 本地登录 MySQL
命令：mysql -u root -p   //root是用户名，输入这条命令按回车键后系统会提示你输入密码

2\. 指定端口号登录 MySQL 数据库
将以上命令：mysql -u root -p  -P 3306 即可，注意指定端口的字母 P 为大写，
而标识密码的 p 为小写。MySQL 默认端口号为 3306

### 安装 mariadb

yum install -y mariadb-server mariadb

启动 mariadb
`systemctl start mariadb`

配置密码, 这里默认使用密码 QcloudLabPASSWORD
`mysqladmin -u root password 'QcloudLabPASSWORD'`

登录 mariadb
`mysql -u root -pQcloudLabPASSWORD`

## 其他说明

### SELinux

1. 运行 getenforce 命令查看 SELinux 的当前状态。

    [![查看SELinux状态](https://upload-images.jianshu.io/upload_images/1662509-734c0f3e8712a208.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/9763/156560602421065_zh-CN.png)

* 如果 SELinux 状态参数是 Disabled， 则 SELinux 为关闭状态。
* 如果 SELinux 状态参数是 Enforcing，则 SELinux 为开启状态。本示例中 SELinux 为开启状态，因此需要关闭 SELinux。

2\. 关闭 SELinux。如果 SELinux 为关闭状态可以忽略此步骤。

* 如果您想临时关闭 SELinux，运行命令 setenforce 0。

**说明** 这只是暂时关闭 SELinux，下次重启 Linux 后，SELinux 还会开启。

* 如果您想永久关闭 SELinux，运行命令 `vi /etc/selinux/config` 编辑 SELinux 配置文件。回车后，把光标移动到 `SELINUX=enforcing` 这一行，按 `i` 键进入编辑模式，修改为 `SELINUX=disabled`， 按 `Esc` 键，然后输入 `:wq` 并按`Enter` 键以保存并关闭 SELinux 配置文件。

**说明** 如果您想重新开启 SELinux，请参见[SELinux 的官方文档](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/5/html/deployment_guide/ch-selinux#s1-SELinux-resources)。
