---
title: 捷键
date: 2023-07-09 12:49:00
updated: 2023-07-09 12:49:00
categories: 我的开源
---

## AutoHotkey 介绍

AutoHotkey 程序本身不做任何事情; 它需要一个脚本来告诉它该做什么. 脚本只是一个简单的以 .ahk 作为扩展名的文本文件, 其中包含了程序的指令, 像配置文件, 但功能更强大。一个脚本可以执行一个动作然后退出, 但大多数脚本定义了一些热键, 当热键按下时, 热键后面跟着的一个或多个动作将会执行。

## 使用

### 快捷键改写

面向窗口

关闭/退出 ctrl + q
最小化 alt + m
最大化 通过鼠标手势软件进行实现

面向多标签应用程序

切换到上个标签 ctrl + shift + tab
切换到下个标签 ctrl + tab
新建标签 ctrl + alt + shfit + t 必要时重新定义了快捷键，同时也为了和其他场景快捷键不冲突，只能如此
关闭标签 ctrl + w 正常情况下统一为 alt + f4 除非有特例
撤销最近关闭标签 ctrl + shift + t

```ahk
; ctrl + q 统一为关闭
^q::Send "!{F4}"
```

### 打开网址

```ahk
#z::Run "https://www.autohotkey.com"  ; Win+Z
```

### 打开程序

```ahk
^!n::  ; Ctrl+Alt+N
{
    if WinExist("Untitled - Notepad")
        WinActivate
    else
        Run "Notepad"
}
```

### 文本操作

```ahk
; 插入 email
:C*:xem::acc8226@qq.com
; 插入 qq
:C*:xqq::1334598467

; 快捷操作-插入双引号 ctrl + shift + "
^+"::Send '""{Left}'
```

### 鼠标增强

```akh
; ----- 6. 鼠标操作 -----

#HotIf mouseIsOverTaskBarOrLeftEdge()
WheelUp::Send "{Volume_Up}"
WheelDown::Send "{Volume_Down}"

; 鼠标在左侧边缘或者在任务栏上
mouseIsOverTaskBarOrLeftEdge() {
    MouseGetPos &OutputVarX,, &Win
    return OutputVarX == 0 or WinExist("ahk_class Shell_TrayWnd" " ahk_id " Win)
}
```

## 实战

基于 autohotkey 我做了款软件。

### 1. 热键 之 鼠标操作

控制音量：鼠标移动到屏幕左边缘 或 任务栏上可通过鼠标滑轮上下

![1](https://foruda.gitee.com/images/1689318820722473769/d4f9efe3_426858.gif "1.gif")

### 2. 热键 之 重写快捷键

* ctrl + alt + shfit + t 新建标签/窗口（支持 vscode、WindowsTerminal、资源管理器、主流浏览器）
* ctrl + shift + tab / ctrl + tab 切换到上/下个标签 （支持 idea 64 位）
* ctrl + w 关闭标签/窗口（支持 vscode、 idea 64 位、QQ、WindowsTerminal、Snipaste、SumatraPDF、wps、微信、主流浏览器）

* Esc 离开窗口 目前仅支持记事本
* ctrl + q 关闭窗口
* alt + m  窗口最小化

注：主流浏览器包含 360 极速浏览器、chrome 谷歌浏览器、DuckDuckGo 浏览器、firefox 火狐浏览器。
理论上兼容的浏览器有（未经过完全测试） 360 安全浏览器、QQ 浏览器、、傲游浏览器、猎豹浏览器、极速浏览器。

（以下部分场景使用了鼠标手势替代输入快捷键）

操作资源管理器

![输入图片说明](https://foruda.gitee.com/images/1689318878983165049/4f89b32d_426858.gif "动画2-3.gif")

操作 360 极速浏览器

![输入图片说明](https://foruda.gitee.com/images/1689320148290015829/d0563e32_426858.gif "2.gif")

操作 idea

![输入图片说明](https://foruda.gitee.com/images/1689318910813101697/359f150e_426858.gif "动画2-4.gif")

操作 vscode

![输入图片说明](https://foruda.gitee.com/images/1689318894573526368/39027a0d_426858.gif "动画2-2.gif")

### 3. 热键 之 打开网址【可自定义】

* alt + 6 打开 bilibili
* alt + 7 打开 IT 之家
* alt + 8 打开 西瓜视频

![输入图片说明](https://foruda.gitee.com/images/1689318923398248705/25b1c4c9_426858.gif "动画3.gif")

### 4. 热键 之 运行程序【可自定义】

* alt + 1 打开 资源管理器
* alt + 4 打开 powershell 终端

* alt + n 打开记事本

![输入图片说明](https://foruda.gitee.com/images/1689318934831690368/2606bf7a_426858.gif "动画4.gif")

### 5. 热键 之 启动文件夹【可自定义】

* alt + d 打开 D 盘

![输入图片说明](https://foruda.gitee.com/images/1689318944226542670/0337e814_426858.gif "动画5.gif")

### 6. 热键 之 其他

* ctrl + 数字 1-5 为光标所在行添加 markdown 格式标题（目前仅放开了 vscode 和 记事本窗口的权限）

![输入图片说明](https://foruda.gitee.com/images/1689318964909077353/0518d03d_426858.gif "动画6.gif")

* ctrl + alt + v 剪贴板的内容输入到当前活动应用程序中，防止了一些网站禁止在 HTML 密码框中进行粘贴操作
* ctrl + shift + "  快捷操作-插入双引号
* Ctrl + Alt + S 禁用脚本
* Ctrl + Alt + R 重启脚本

### 7. 简单快捷启动器【可自定义】

alt + 空格 开启快捷启动器，再次按下或鼠标在部件外点击 / esc 键则关闭。

只要输入对应启动程序/网址的全拼或首字母简拼这种模糊搜索，如果候选词有多个可以按下 tab 键切换到列表框中方向上下键选中后回车或鼠标双击。

#### 百度搜索

在弹出输入框，接着输入 bd （空格）yyds 回车进行百度搜索。

![输入图片说明](https://foruda.gitee.com/images/1689321508560702893/2457a573_426858.gif "2.gif")

#### 快速跳转到应用程序、文件位置和网址

bd 加回车打开百度网

![输入图片说明](https://gitee.com/acc8226/my-cmd/raw/main/markdown/imgs/7%20%E6%89%93%E5%BC%80%E7%99%BE%E5%BA%A6.apng)

kz 加回车打开控制面板

![输入图片说明](https://gitee.com/acc8226/my-cmd/raw/main/markdown/imgs/7%20%E6%89%93%E5%BC%80%E6%8E%A7%E5%88%B6%E9%9D%A2%E6%9D%BF.apng)

### 8. 热串 之 直达网址（Z 直达模式）【可自定义】

* zbd 打开百度
* zbi 打开 哔哩哔哩
* zca 打开彩云小译
* zdy 打开抖音
* zit 打开 IT 之家
* zjs 打开简书网
* zma 打开 QQ 邮箱
* zxg 打开西瓜视频

在任意界面中输入 zbd 打开百度首页

![输入图片说明](https://foruda.gitee.com/images/1689318989538537685/7b71d232_426858.gif "动画7-1.gif")

输入 zbi 打开 b 站

![输入图片说明](https://foruda.gitee.com/images/1689319007424875617/4934e693_426858.gif "动画7-2.gif")

### 9. 热串之 扩展片段：将字符串替换为自定义话术（X 拓展模式）【可自定义】

* xnb 很牛呀
* xnm 你妹的

![](https://foruda.gitee.com/images/1689259764657007580/13e4cb48_426858.gif "8.gif")

* xwx 😄 微笑
* xlh 😊 脸红
* xok 👌 OK
* xax ❤️ 爱心
* xbz 📰 报纸
* xbq 🏷️ 标签
* xsq 🔖 书签
* xsh 💩 大便
* xgh 👻 鬼魂

![](https://foruda.gitee.com/images/1689259802922906219/d546cc12_426858.gif "10.gif")

### 10. 自定义配置说明

默认读取 appList.csv 配置，文本编码为 utf-8。可自行修改文本内容。

建议使用 LiberOffice 打开。

### 自定义热键 和 热串

* type: app or web or file or text
* path：实际运行的网址或程序路径
* hk：绑定的热键，例如 !6 表示 ctrl + 数字 6
* hs：绑定的热串

注： hk 和 hs 至少绑定其中一个，否则绑定无效

![输入图片说明](https://gitee.com/acc8226/my-cmd/raw/main/markdown/imgs/%E7%BB%91%E5%AE%9A%E5%85%B6%E4%BB%96%E4%B8%89.jpg)

### 快捷启动-手动添加启动项

* type: app or web
* title：名称
* path：实际运行的网址或程序路径
* alias：匹配关键字，若有多个通过 | 进行分割。

![输入图片说明](https://gitee.com/acc8226/my-cmd/raw/main/markdown/imgs/%E5%BF%AB%E6%8D%B7%E5%90%AF%E5%8A%A8%E5%9B%9B%E8%A6%81%E7%B4%A0.jpg)

## 地址

AutoHotkey
<https://www.autohotkey.com/>

快速参考 | AutoHotkey v2
<https://wyagd001.github.io/v2/docs/>

【win】ahk script · acc8226/我的脚本 - 码云 - 开源中国
<https://gitee.com/acc8226/my-cmd/tree/main/%E3%80%90win%E3%80%91ahk%20script>

## 学习

动态 HotIfWinActive 两者都可

```ahk
HotIfWinActive "ahk_exe Code.exe"
Hotkey "!n", MyFunc  ; 创建一个只在记事本中工作的热键.

MyFunc(ThisHotkey)
{
    MsgBox "You pressed " ThisHotkey
}

HotIfWinActive("ahk_exe Code.exe")
Hotkey "!n", MyFunc  ; 创建一个只在记事本中工作的热键.

MyFunc(ThisHotkey)
{
    MsgBox "You pressed " ThisHotkey
}
```

dll 学习

```ahk
WhichButton := DllCall("MessageBox", "Int", 0, "Str", "Press Yes or No", "Str", "Title of box", "Int", 4)
MsgBox "You pressed button #" WhichButton
```

Suspend 禁用或启用所有的或选择的热键和热字串
Pause 暂停脚本的当前线程 感觉不怎么能用到
