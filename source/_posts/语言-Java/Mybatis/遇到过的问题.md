---
title: MyBatis-遇到过的问题
date:
updated:
categories:
  - 语言-Java
  - 框架-MyBatis
tags:
- Java
- MyBatis
---

## 遇到过的问题

### mysql 中判断记录是否存在方法比较_u013078295的博客-CSDN博客_mysql查询记录是否存在

<https://blog.csdn.net/u013078295/article/details/75305624>

Mybatis 报错 attempted to return null from a method with a primitive return type (int).-看准网
<https://www.kanzhun.com/jiaocheng/387212.html>

【java】Mybatis 返回 int 类型为空时报错 attempted to return null from a method with a primitive return type (int）_哈士奇-CSDN博客
<https://blog.csdn.net/kisscatforever/article/details/77801060>

"nested exception is org.apache.ibatis.reflection.ReflectionException: There is no getter for property named 'paymentTypeCode' in 'class java.lang.String'"

xml 中 或者在 类方法上写的 sql 语句有问题

### SpringBoot 整合 Mybatis 报错 Consider defining a bean of type 'xx.xx.xx' in your configur

Consider defining a bean of type 'com.poly.ncl.chargepaychange.mapper.ChargePayChangeMapper' in your configuration.

这是由于 springBoot 启动时，没有扫描到 com.alibaba.dao.EntFileDao，而在 com.alibaba.serviceImpl.EntFileServiceImpl 中又使用了 @autowired private EnfileDao entFileDao 进行装配，所以会发现错误，说没有定义。此时需要在 springBoot 的启动类上，加个注解：@MapperScan("持久层路径")，这样就会扫描到 com.alibaba.dao.EntFileDao 了。

原文：<https://blog.csdn.net/weixin_39800144/article/details/79176373>

### java.sql.SQLException: Incorrect string value: '\xF0\x9F\xA7\xA1",...'

```text
### Cause: java.sql.SQLException: Incorrect string value: '\xF0\x9F\xA7\xA1",...' for column 'req_body' at row 1
; uncategorized SQLException; SQL state [HY000]; error code [1366]; Incorrect string value: '\xF0\x9F\xA7\xA1",...' for column 'req_body' at row 1; nested exception is java.sql.SQLException: Incorrect string value: '\xF0\x9F\xA7\xA1",...' for column 'req_body' at row 1
    at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:89)
```

错误原因：参数中带有 emoji 表情，插入数据库时，一些特殊字符如“🌙”，插入报异常

解决思路：因为字符编码集为 utf8,不支持一些 basic multilingual plane 和补充字符，那么如何让 mysql 存储 emoji表情，所以需要改成 utf8mb4.

解决方法：

```java
package com.zhangsan.product.utils;

import java.util.regex.Pattern;

public class EmojiUtil {

    /**
     * emoji表情替换
     *
     * @param source 原字符串
     * @return 过滤后的字符串
     */
    public static String filterEmoji(String source) {
        String target;
        if (source != null && source.length() > 0) {
            target = pattern.matcher(source).replaceAll("");
        } else {
            target = source;
        }
        return target;
    }

    private static final Pattern pattern = Pattern.compile("[\ud800\udc00-\udbff\udfff\ud800-\udfff]");

    private EmojiUtil() {
    }
}
```

### "nested exception is org.apache.ibatis.builder.BuilderException: Error evaluating expression 'cardNumber != null AND cardNumber != '''. Cause: org.apache.ibatis.ognl.ExpressionSyntaxException: Malformed OGNL expression: cardNumber != null AND cardNumber != '' [org.apache.ibatis.ognl.ParseException: Encountered

'cardNumber != null AND cardNumber != '''。

原因是我将 and 大写了。

修改后就好了

'cardNumber != null and cardNumber != '''。

## 参考

SpringBoot 整合 Mybatis 报错:Consider defining a bean of type ‘xx.xx.xx‘ in your configur_IT云清的博客-CSDN博客_mybatisplus consider defining a bean of type
<https://blog.csdn.net/weixin_39800144/article/details/79176373>
