---
title: 01. Kotlin 的数据类型和变量
date: 2022-10-07 21:44:00
updated: 2022-10-07 21:44:00
categories:
  - 语言
  - Kotlin
tags:
- kotlin
---

## 数据类型

### 基本数据类型

与 Java 基本类型相对应，Kotlin 也有 8 种基本数据类型。

* 整数类型：Byte、Short、Int和Long，Int是默认类型。
* 浮点类型：Float和Double，Double是默认类型。
* 字符类型：Char。
* 布尔类型：Boolean

Kotlin 的 8 个基本数据类型没有对应的包装类，Kotlin 编译器会根据不同的场景将其编译成为 Java 中的基本类型数据还是包装类对象。例如，Kotlin 的 Int 用来声明变量、常量、属性、函数参数类型和函数返回类型等情况时，被编译为Java的int类型；当作为集合泛型类似参数时，则被编译为 Java 的 java.lang.Integer，这是因为 Java 集合中只能保存对象，不能是基本数据类型。Kotlin 编译器如此设计是因为基本类型数据能占用更少的内存，运行时效率更高。

> **Java 程序员注意**　在 Java 中表示 long 类型整数时可以在数字后面加小写英文字母 l，但由于可读性不好，容易被误认为是阿拉伯数字 1，所以在 Kotlin 中部不允许这样表示。

在使用整数变量赋值，还可以使用二进制和十六进制表示，但不支持八进制，它们的表示方式分别如下：

* 二进制数：以 0b 或 0B 为前缀，注意 0 是阿拉伯数字，不要误认为是英文字母 o。
* 十六进制数：以 0x 或 0X 为前缀，注意 0 是阿拉伯数字。

**深入了解：Kotlin 中的 Java 基本数据类型**
和 Java 不同，Kotlin 只提供引用类型这一种数据类型。

为了让你愉快地使用引用类型，Kotlin在后台改用了性能更佳的基本数据类型。假如你熟悉 Java 的八大基本数据类型，也能在 Kotlin 中分别找到它们的对应引用数据类型。

### 引用数据类型

出来基础数据的其他类型都是该类型。比如 map、set、array。

## 变量 Variables

Kotlin 有强大的类型推断能力。虽然您可以显式地声明变量的类型，但通常会让编译器通过推断来完成这项工作。Kotlin 并不强制执行不变性，尽管它是被推荐的。本质上使用 val/var。

在 Kotlin 中声明变量，就是在标识符的前面加上关键字 var。
变量一旦赋值就不能更改。要声明只读变量，使用 val 关键字。

```kt
// kotlin 可自动推断变量类型
var y = 20
// 声明并指定数据类型
var scoreForStudent: Float = 0.0f
```

**使用 var 还是 val？**

如果两种方式都能满足需求情况下，原则上优先考虑使用 val 声明。因为一方面 val 声明的变量是只读，一旦初始化后不能修改，这可以避免程序运行过程中错误地修改变量内容；另一方面在声明引用类型使用 val，对象的引用不会被修改，但是引用内容可以修改，这样会更加安全，也符合函数式编程的技术要求。

注意：你可以自由选择何时初始化变量，但是，它必须在第一次读之前初始化。

```kt
val d: Int  // 1

if (someCondition()) {
    d = 1   // 2
} else {
    d = 2   // 2
}

println(d) // 3
```

### 编译时常量

常量一旦初始化后就不能再被修改。

const val 声明的是编译期常量，常量是在编译时初始化，只能用于顶层常量声明或声明对象中的常量声明。由于使用复杂的数据类型可能会危害编译时的安全保障，所以编译时常量只能是一些常见的基本数据类型。

* String
* Int
* Double
* Float
* Long
* Short
* Byte
* Char
* Boolean

## Null Safety

为了消除 nullPointerException，Kotlin 的变量类型不允许赋值 null。如果您需要一个可以为空的变量，可以通过添加？在其类型的末端。

```kt
var nullable: String? = "You can keep a null here"
nullable = null
```

### Working with Nulls

有时候，Kotlin 程序需要使用 null 值，例如在与外部 Java 代码交互时，或者表示一个真正缺失的状态时。Kotlin 提供空跟踪来优雅地处理这种情况。

```kt
fun describeString(maybeString: String?): String {              // 1
    if (maybeString != null && maybeString.length > 0) {        // 2
        return "String of length ${maybeString.length}"
    } else {
        return "Empty or null string"                           // 3
    }
}
```

1. 接受可为空的字符串并返回其说明的函数。
2. 如果给定的字符串不为空，也不为空，则返回有关其长度的信息。
3. 否则，告诉调用方字符串为空或 null。

## 参考

Kotlin 编程权威指南
<https://www.ituring.com.cn/book/tupubarticle/27591?bookID=2610>
